(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{103:function(e,t,n){e.exports=n(116)},113:function(e,t,n){},116:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(11),i=n.n(c),u=n(9),s=n(40),o=n(86),l=n(10),p=n.n(l),m=n(16),f=n(29),d=n.n(f),E=function(e){return{type:"campaigns/SET_CAMPAIGNS",campaigns:e}},g=function(e){return{type:"campaigns/REMOVE_CAMPAIGN",campaignId:e}};var h=function(e){return{type:"categories/SET_CATEGORIES",categories:e}};var b=function(e){return{type:"tags/SET_TAGS",tags:e}};var v=n(70),O=function(e,t,n,a){return function(){var r=Object(m.a)(p.a.mark((function r(c){var i,u,s,o,l,m;return p.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return i=d.a.get("XSRF-TOKEN"),u=JSON.stringify({noteContent:e,hashtagIds:t,newHashtags:a,csrf_token:i}),r.next=4,fetch("/api/campaigns/".concat(n,"/"),{method:"post",headers:{"Content-Type":"application/json","X-CSRFTOKEN":i},body:u});case 4:return s=r.sent,r.next=7,s.json();case 7:return o=r.sent,s.ok&&!o.errors?(l=o.newNote,m=o.newTags,c({type:"notes/ADD_NOTE",note:l}),c({type:"tags/ADD_TAGS",tags:m}),s.errors=[]):s.errors=o.errors,r.abrupt("return",s);case 10:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}()};var j=function(e){return{type:"ui/SET_CURRENT_SESSION",currentSession:e}},y={currentSession:{},pinnedTags:[],currentCampaign:{}};var C=function(e){return{type:"auth/SET_USER",user:e}};var x,S=Object(s.c)({campaigns:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=Object.assign({},e);switch(t.type){case"campaigns/SET_CAMPAIGNS":return t.campaigns;case"campaigns/ADD_CAMPAIGN":var a=t.campaign;return n[a.id]=a,n;case"campaigns/REMOVE_CAMPAIGN":return delete n[t.campaignId],n;case"campaigns/CLEAR_CAMPAIGNS":return{};default:return e}},categories:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"categories/SET_CATEGORIES":return t.categories;case"categories/CLEAR_CATEGORIES":return[];default:return e}},tags:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=Object.assign({},e);switch(t.type){case"tags/SET_TAGS":return t.tags;case"tags/ADD_TAG":return n[t.tag.name]=t.tag,n;case"tags/ADD_TAGS":return Object.values(t.tags).forEach((function(e){n[e.name]=e})),n;case"tags/CLEAR_TAGS":return{};default:return e}},notes:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=Object.assign({},e);switch(t.type){case"notes/ADD_NOTE":var a=t.note;return a.tags.forEach((function(e){e in n&&(n[e]=[].concat(Object(v.a)(n[e]),[a]))})),n;case"notes/SET_NOTES":return n[t.tagName]=t.notes,n;case"notes/CLEAR_NOTES":return{};default:return e}}}),T=Object(s.c)({auth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{id:null},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"auth/SET_USER":return t.user;default:return e}},entities:S,ui:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:y,t=arguments.length>1?arguments[1]:void 0,n=Object.assign({},e);switch(t.type){case"ui/SET_CURRENT_CAMPAIGN":return n.currentCampaign=t.currentCampaign,n;case"ui/SET_CURRENT_SESSION":return n.currentSession=t.currentSession,n;case"ui/SET_PINS":return n.pinnedTags=t.pins,n;case"ui/PIN_TAG":var a=[].concat(Object(v.a)(n.pinnedTags),[t.tag]);return n.pinnedTags=a,n;case"ui/CLEAR_UI":return y;default:return e}}});x=Object(s.a)(o.a);n(113);var w=n(23),N=n(56),k=n(170),A=n(90),_=n(169),I=n(150),R=n(152),D=n(172),G=n(54),F=n(153),L=n(148),P=n(43),U=n.n(P),M=Object(L.a)((function(e){return{toolbar:{height:"6vh",justifyContent:"space-between",alignItems:"center"},appBar:{height:"6vh",zIndex:e.zIndex.drawer+1}}})),K=function(){var e=Object(u.b)(),t=M(),n=Object(u.c)((function(e){return e.ui.currentCampaign})),a=Object(u.c)((function(e){return e.auth}));return r.a.createElement(r.a.Fragment,null,r.a.createElement(I.a,{className:t.appBar,position:"fixed"},r.a.createElement(R.a,{display:"flex",variant:"dense",className:t.toolbar},r.a.createElement(D.a,{onClick:function(e){e.preventDefault(),window.location="/"}},r.a.createElement(G.a,{variant:"button"},"LoreKeeper")),r.a.createElement(D.a,null,r.a.createElement(F.a,{endIcon:r.a.createElement(U.a,null)},n.title?n.title:r.a.createElement(G.a,{variant:"button"},"Select a Campaign!"))),r.a.createElement(D.a,null,a.is_authenticated?r.a.createElement(F.a,{onClick:function(t){t.preventDefault(),e(function(){var e=Object(m.a)(p.a.mark((function e(t){var n,a,r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=d.a.get("XSRF-TOKEN"),e.next=3,fetch("/api/session/logout/",{method:"get",headers:{"Content-Type":"application/json","XSRF-TOKEN":n}});case 3:return a=e.sent,e.next=6,a.json();case 6:return r=e.sent,a.ok&&!r.errors?(t(C({id:null})),t({type:"campaigns/CLEAR_CAMPAIGNS"}),t({type:"categories/CLEAR_CATEGORIES"}),t({type:"tags/CLEAR_TAGS"}),t({type:"notes/CLEAR_NOTES"}),t({type:"ui/CLEAR_UI"})):a.errors=r.errors,e.abrupt("return",a);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}},"Logout"):r.a.createElement(F.a,{onClick:function(t){var n,a;t.preventDefault(),e((n="Ian",a="password",function(){var e=Object(m.a)(p.a.mark((function e(t){var r,c,i,u;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=d.a.get("XSRF-TOKEN"),e.next=3,fetch("/api/session/login/",{method:"post",headers:{"Content-Type":"application/json","X-CSRFTOKEN":r},body:JSON.stringify({username:n,password:a,csrf_token:r})});case 3:return c=e.sent,e.next=6,c.json();case 6:return i=e.sent,u=i.campaigns,t(E(u)),delete i.campaigns,c.ok&&!i.errors?(t(C(i)),c.data=i):c.errors=i.errors,e.abrupt("return",c);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()))}},"Login")))))},X=n(15),B=function(e){var t=e.component,n=e.path,a=e.currentUser,c=e.exact;e.history;return r.a.createElement(X.b,{path:n,exact:c,render:function(e){return a.is_authenticated&&!a.is_anonymous?r.a.createElement(t,e):r.a.createElement(X.a,{to:"/"})}})},H=function(e){var t=e.component,n=e.path,a=e.currentUser,c=e.exact;e.history;return r.a.createElement(X.b,{path:n,exact:c,render:function(e){return a.is_authenticated?r.a.createElement(X.a,{to:"/users/".concat(a.id,"/campaigns")}):r.a.createElement(t,e)}})},J=Object(L.a)((function(e){return{welcomeContainer:{display:"flex",height:"100vh",justifyContent:"center",alignItems:"center"}}})),W=function(){var e=J();return r.a.createElement(r.a.Fragment,null,r.a.createElement(D.a,{className:e.welcomeContainer},r.a.createElement(G.a,{variant:"h1"},"Welcome!")))},z=n(164),V=n(154),Y=n(87),$=n.n(Y),q=n(155),Q=n(156),Z=n(157),ee=n(158),te=n(159),ne=n(65),ae=n.n(ne),re=Object(L.a)({campaignCard:{cursor:"pointer",height:"180px"}}),ce=function(e){var t=e.campaign,n=re(),a=Object(u.b)(),c=t.id,i=t.title,s=t.description;return r.a.createElement(r.a.Fragment,null,r.a.createElement(V.a,{item:!0,xs:4},r.a.createElement(q.a,{onClick:function(e){e.preventDefault(),window.location="/campaigns/".concat(e.currentTarget.id)},id:c,className:n.campaignCard},r.a.createElement(Q.a,null,r.a.createElement(Z.a,null,r.a.createElement(ee.a,null,r.a.createElement(G.a,{variant:"button"},i))),r.a.createElement(Z.a,null,r.a.createElement(ee.a,null,r.a.createElement(G.a,{variant:"caption"},s)))),r.a.createElement(te.a,{className:n.cardActions},r.a.createElement(F.a,{onClick:function(e){var t;e.preventDefault(),e.stopPropagation(),a((t=c,function(){var e=Object(m.a)(p.a.mark((function e(n){var a,r,c;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=d.a.get("XSRF-TOKEN"),e.next=3,fetch("/api/campaigns/".concat(t,"/"),{method:"delete",headers:{"Content-Type":"application/json","X-CSRFTOKEN":a}});case 3:return r=e.sent,e.next=6,r.json();case 6:return c=e.sent,r.ok&&!c.errors?n(g(t)):r.errors=c.errors,e.abrupt("return",r);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()))}},r.a.createElement(ae.a,null))))))},ie=n(160),ue=n(161),se=n(162),oe=n(171),le=n(163),pe=function(e){var t=e.open,n=Object(u.b)(),c=(Object(u.c)((function(e){return e.auth.id})),Object(a.useState)(t)),i=Object(w.a)(c,2),s=i[0],o=i[1],l=Object(a.useState)(""),f=Object(w.a)(l,2),E=f[0],g=f[1],h=Object(a.useState)(""),b=Object(w.a)(h,2),v=b[0],O=b[1];Object(a.useEffect)((function(){o(t)}),[n,t]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(ie.a,{open:s,onClose:function(e){e.preventDefault(),o(!s)}},r.a.createElement(ue.a,null,"Create a new Campaign"),r.a.createElement(se.a,null,r.a.createElement(oe.a,{autoFocus:!0,id:"title",lable:"Title",placeholder:"The title of your campaign (<50 characters)",fullWidth:!0,onChange:function(e){e.preventDefault(),g(e.target.value)}}),r.a.createElement(oe.a,{id:"Description",lable:"Description",placeholder:"A brief description of your campaign",fullWidth:!0,multiline:!0,onChange:function(e){e.preventDefault(),O(e.target.value)}}),r.a.createElement(le.a,null,r.a.createElement(F.a,{onClick:function(e){e.preventDefault(),n(function(e,t){return function(){var n=Object(m.a)(p.a.mark((function n(a){var r,c,i;return p.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=d.a.get("XSRF-TOKEN"),n.next=3,fetch("/api/campaigns/",{method:"post",headers:{"Content-Type":"application/json","X-CSRFTOKEN":r},body:JSON.stringify({title:e,description:t,csrf_token:r})});case 3:return c=n.sent,n.next=6,c.json();case 6:return i=n.sent,c.ok&&!i.errors?a({type:"campaigns/ADD_CAMPAIGN",campaign:i.campaign}):c.errors=i.errors,n.abrupt("return",c);case 9:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()}(E,v))},color:"primary"},"Add Campaign")))))},me=Object(L.a)({yourCampaignsHeader:{padding:"40px 0px"},addButton:{cursor:"pointer",marginLeft:"40px"},campaignsContainer:{paddingTop:"6vh"}}),fe=function(e){var t=Object(u.b)(),n=e.match.params.userId,c=Object(u.c)((function(e){return e.entities.campaigns})),i=me(),s=Object(a.useState)(!1),o=Object(w.a)(s,2),l=o[0],f=o[1];return Object(a.useEffect)((function(){t(function(e){return function(){var t=Object(m.a)(p.a.mark((function t(n){var a,r;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("/api/users/".concat(e,"/campaigns/"));case 2:return a=t.sent,t.next=5,a.json();case 5:return r=t.sent,a.ok&&!r.errors?n(E(r.campaigns)):a.errors=r.errors,t.abrupt("return",a);case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}(n))}),[t]),r.a.createElement(r.a.Fragment,null,r.a.createElement(pe,{open:l}),r.a.createElement(z.a,{className:i.campaignsContainer},r.a.createElement(G.a,{className:i.yourCampaignsHeader,variant:"h4"},"Your Campaigns",r.a.createElement(F.a,{className:i.addButton,variant:"contained",onClick:function(e){e.preventDefault(),f(!l)}},r.a.createElement($.a,null))),r.a.createElement(V.a,{container:!0,spacing:3},c?Object.values(c).map((function(e){return r.a.createElement(ce,{key:e.id,campaign:e})})):r.a.createElement(r.a.Fragment,null))))},de=n(173),Ee=n(165),ge=n(166),he=n(174),be=n(168),ve=n(167),Oe=n(119),je=n(88),ye=n.n(je),Ce=n(89),xe=n.n(Ce),Se=Object(L.a)((function(e){return{tagsList:{width:"100%"}}})),Te=function(e){var t=e.tag,n=Object(u.b)();return r.a.createElement(de.a,{key:t.id},r.a.createElement(Ee.a,{expandIcon:r.a.createElement(U.a,null)},r.a.createElement(G.a,null,t.name)),r.a.createElement(ge.a,null),r.a.createElement(ve.a,null,r.a.createElement(Oe.a,{onClick:function(){n(function(e){return{type:"ui/PIN_TAG",tag:e}}(t))}},r.a.createElement(ye.a,null)),r.a.createElement(Oe.a,{onClick:function(){}},r.a.createElement(xe.a,null)),r.a.createElement(Oe.a,{onClick:function(){}},r.a.createElement(ae.a,null))))},we=function(e){var t=e.catId,n=(e.tagIds,Se()),a=Object(u.c)((function(e){return Object.values(e.entities.tags).filter((function(e){return e.category_id===t}))}));return r.a.createElement(r.a.Fragment,null,r.a.createElement(Q.a,{className:n.tagsList},a?a.map((function(e){return r.a.createElement(Te,{tag:e})})):r.a.createElement("p",null,"...")))},Ne=n(91),ke=Object(L.a)((function(e){return{notecard:{width:"250px",paddingTop:"2px"},pinnedTag:{flexDirection:"column",alignItems:"center"}}})),Ae=function(e){var t=e.index,n=e.style,a=e.data[t];return r.a.createElement(Z.a,{style:n,key:t},r.a.createElement(ee.a,{primary:a.content}))},_e=function(e){var t=e.tag,n=ke(),c=Object(u.b)(),i=Object(u.c)((function(e){return e.entities.notes[t.name]})),s=Object(a.useState)(100),o=Object(w.a)(s,2),l=o[0],f=o[1],d=function(){var e=window.innerHeight-320;f(e)};return Object(a.useEffect)((function(){c(function(e){return function(){var t=Object(m.a)(p.a.mark((function t(n){var a,r,c;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("/api/notes/".concat(e.id,"/"));case 2:return a=t.sent,t.next=5,a.json();case 5:r=t.sent,c=r.savedNotes,a.ok&&n({type:"notes/SET_NOTES",tagName:e.name,notes:c});case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}(t)),d(),window.addEventListener("resize",d)}),[c]),r.a.createElement(r.a.Fragment,null,r.a.createElement(D.a,{className:n.pinnedTag,display:"flex"},r.a.createElement(G.a,{variant:"h5"},t.name),r.a.createElement(Ne.a,{height:l,width:360,itemSize:80,itemCount:i?i.length:0,itemData:i},Ae)))},Ie=Object(L.a)((function(e){return{corkboard:{flexDirection:"row"}}})),Re=function(){var e=Ie(),t=Object(u.c)((function(e){return e.ui.pinnedTags}));return r.a.createElement(r.a.Fragment,null,r.a.createElement(D.a,{className:e.corkboard,display:"flex"},t.map((function(e){return r.a.createElement(_e,{tag:e})}))))},De=Object(L.a)({helpCard:{width:"320px"}}),Ge=function(){var e=De();return r.a.createElement(q.a,{className:e.helpCard},r.a.createElement(be.a,null,r.a.createElement(G.a,null,"How to use: Just start typing!  Every note automatically includes the current session's tag, but you can add existing or new tags by just adding a '#' at the beginning of its name! (Avoid puntuation like apostraphes and commas.  Hyphens are cool though)")))},Fe=Object(L.a)({dashboardBox:{display:"flex",height:"100vh",paddingTop:"6vh"},categoryList:{paddingTop:"50px"},drawer:{width:"250px",flexShrink:0},content:{flexGrow:1,display:"flex",flexDirection:"column"},corkBoard:{flexGrow:1},notePadContainer:{width:"100%",height:"225px",padding:"8px",display:"flex",justifyContent:"center"},notePad:{height:"100%",width:"100%",maxWidth:"600px",margin:"0px 8px"},noteField:{width:"100%"},helpCard:{width:"320px"}}),Le=function(e){var t=e.match.params.id,n=Object(u.b)(),c=Fe(),i=Object(u.c)((function(e){return e.entities.categories})),s=Object(u.c)((function(e){return e.entities.tags})),o=Object(u.c)((function(e){return e.ui.currentSession})),l=Object(a.useState)(""),f=Object(w.a)(l,2),d=f[0],E=f[1],g=Object(a.useState)(!1),v=Object(w.a)(g,2),y=v[0],C=v[1],x=function(){var e=Object(m.a)(p.a.mark((function e(a){var r,c,i,u,l;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.preventDefault(),r=d.split(" "),c=r.filter((function(e){return e.startsWith("#")})),i=[],u=[],c.forEach((function(e){(e=e.replace(/[.,\/!$%\^&\*;:{}=`~()]/g,"").toLowerCase())in s?i.push(s[e].id):u.push(e)})),l=n(O(d,i,t,u)),E("".concat(o.name," ")),!("errors"in l)){e.next=10;break}return e.abrupt("return");case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();Object(a.useEffect)((function(){(function(){var e=Object(m.a)(p.a.mark((function e(){var a,r,c,i;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/campaigns/".concat(t));case 2:if(!(a=e.sent).ok){e.next=15;break}return e.next=6,a.json();case 6:r=e.sent,n(h(r.categories)),n(b(r.tags)),c=Object.values(r.tags).filter((function(e){return 2===e.category_id})),i=c[c.length-1],n({type:"ui/SET_CURRENT_CAMPAIGN",currentCampaign:r.campaign}),n(j(i)),n({type:"ui/SET_PINS",pins:r.pins}),E("".concat(i.name," "));case 15:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[n]);return r.a.createElement(D.a,{className:c.dashboardBox},r.a.createElement(he.a,{className:c.drawer,variant:"permanent"},r.a.createElement(Q.a,{className:c.categoryList},i?i.map((function(e){return r.a.createElement(de.a,{key:e.id},r.a.createElement(Ee.a,{expandIcon:r.a.createElement(U.a,null)},r.a.createElement(G.a,null,e.name)),r.a.createElement(ge.a,null,r.a.createElement(we,{catId:e.id,tagIds:e.tags})))})):r.a.createElement("p",null,"Loading"))),r.a.createElement(D.a,{className:c.content},r.a.createElement(D.a,{className:c.corkBoard},r.a.createElement(Re,null)),r.a.createElement(D.a,{className:c.notePadContainer},r.a.createElement(q.a,{className:c.notePad},r.a.createElement(be.a,null,r.a.createElement(oe.a,{className:c.noteField,label:'Note contents.  Use "#" at the start of any tags you want to add',multiline:!0,rows:4,variant:"outlined",InputLabelProps:{shrink:!0},onChange:function(e){E(e.currentTarget.value)},value:d})),r.a.createElement(te.a,null,r.a.createElement(F.a,{onClick:x},"Submit"),r.a.createElement(F.a,{onClick:function(e){C(!y)}},y?"Close Help":"?"))),y?r.a.createElement(Ge,null):r.a.createElement(r.a.Fragment,null))))},Pe=function(e){var t=e.user;return r.a.createElement(r.a.Fragment,null,r.a.createElement(X.d,null,r.a.createElement(B,{path:"/users/:userId/campaigns",exact:!0,component:fe,currentUser:t}),r.a.createElement(B,{path:"/campaigns/:id",exact:!0,component:Le,currentUser:t}),r.a.createElement(H,{path:"/",exact:!0,component:W,currentUser:t})))},Ue=Object(A.a)({palette:{type:"dark"}});var Me,Ke=function(){var e=Object(u.b)(),t=Object(a.useState)(!0),n=Object(w.a)(t,2),c=n[0],i=n[1];Object(a.useEffect)((function(){(function(){var e=Object(m.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/session/csrf/");case 2:if(!e.sent.ok){e.next=5;break}return e.abrupt("return");case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[e]),Object(a.useEffect)((function(){(function(){var t=Object(m.a)(p.a.mark((function t(){var n,a;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("/api/session/current-user/");case 2:if(!(n=t.sent).ok||n.errors){t.next=8;break}return t.next=6,n.json();case 6:a=t.sent,e(C(a));case 8:i(!1);case 9:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}})()()}),[e]);var s=Object(u.c)((function(e){return e.auth}));return c?r.a.createElement(W,null):r.a.createElement(_.a,{theme:Ue},r.a.createElement(k.a,null),r.a.createElement(N.a,null,r.a.createElement(K,null),r.a.createElement(Pe,{user:s})))},Xe=Object(s.d)(T,Me,x);i.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(u.a,{store:Xe},r.a.createElement(Ke,null))),document.getElementById("root"))}},[[103,1,2]]]);
//# sourceMappingURL=main.f9111d7e.chunk.js.map